lenF <= len(ddatanos$NZ.NO3)
grouped_datanos <- data.frame(matrix_datanos,c(rep("A",lenA),rep("B",lenB),rep("C",lenC),rep("D",lenD),rep("E",lenE),rep("F",lenF)))
lenA <= len(ddatanos$NZ.SG)
lenA <- len(ddatanos$NZ.SG)
lenB <- len(ddatanos$NZ.O)
lenC <- len(ddatanos$NZ.N)
lenD <- len(ddatanos$NZ.SG2)
lenE <- len(ddatanos$NZ.NO2)
lenF <- len(ddatanos$NZ.NO3)
lenA <- nrow(ddatanos$NZ.SG)
lenA <- nrow(ddatanos$NZ.SG)
lenB <- nrow(ddatanos$NZ.O)
lenC <- nrow(ddatanos$NZ.N)
lenD <- nrow(ddatanos$NZ.SG2)
lenE <- nrow(ddatanos$NZ.NO2)
lenF <- nrow(ddatanos$NZ.NO3)
grouped_datanos <- data.frame(matrix_datanos,c(rep("A",lenA),rep("B",lenB),rep("C",lenC),rep("D",lenD),rep("E",lenE),rep("F",lenF)))
rep("A",lenA)
lenA
lenA <- nrows(ddatanos$NZ.SG)
lenA <- nrow(ddatanos)
grouped_datanos <- data.frame(matrix_datanos,c(rep("A",len),rep("B",len),rep("C",len),rep("D",len),rep("E",len),rep("F",len)))
len <- nrow(ddatanos)
grouped_datanos <- data.frame(matrix_datanos,c(rep("A",len),rep("B",len),rep("C",len),rep("D",len),rep("E",len),rep("F",len)))
pcanos <- prcomp(matrix_datanos, center = TRUE,scale=TRUE)
plot(pcanos$x[, 1], pca$x[, 2], pch=21, bg=c("blue","cyan","green","yellow","black","pink")[grouped_data[,7]], main = "PCA", xlab = "PC1", ylab = "PC2")
plot(pcanos$x[, 1], pcanos$x[, 2], pch=21, bg=c("blue","cyan","green","yellow","black","pink")[grouped_datanos[,7]], main = "PCA", xlab = "PC1", ylab = "PC2")
View(grouped_datanos)
plot(pcanos$x[, 1], pcanos$x[, 2], pch=21, bg=c("blue","cyan","green","yellow","black","pink")[grouped_datanos[,6]], main = "PCA", xlab = "PC1", ylab = "PC2")
plot(grouped_data[,1],grouped_data[,2], pch=21, xlab="Expression level gene X",ylab="Expression level gene Y",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
plot(grouped_data[,1],grouped_data[,3], pch=21, xlab="Expression level gene X",ylab="Expression level gene Z",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
plot(grouped_data[,2],grouped_data[,3], pch=21, xlab="Expression level gene Y",ylab="Expression level gene Z",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
pca <- prcomp(matrix_data, center = TRUE)
plot(pca$x[, 1], pca$x[, 2], pch=21, bg=c("blue","cyan","green")[grouped_data[,4]], main = "PCA", xlab = "PC1", ylab = "PC2")
pca <- prcomp(matrix_data, center = TRUE)
plot(pca$x[, 1], pca$x[, 2], pch=21, bg=c("blue","cyan","green")[grouped_data[,3]], main = "PCA", xlab = "PC1", ylab = "PC2")
grouped_data <- data.frame(matrix_data,c(rep("A",200),rep("B",200),rep("C",60)))
plot(grouped_data[,1],grouped_data[,2], pch=21, xlab="Expression level gene X",ylab="Expression level gene Y",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
plot(grouped_data[,1],grouped_data[,3], pch=21, xlab="Expression level gene X",ylab="Expression level gene Z",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
plot(grouped_data[,2],grouped_data[,3], pch=21, xlab="Expression level gene Y",ylab="Expression level gene Z",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
pca <- prcomp(matrix_data, center = TRUE)
plot(pca$x[, 1], pca$x[, 2], pch=21, bg=c("blue","cyan","green")[grouped_data[,4]], main = "PCA", xlab = "PC1", ylab = "PC2")
View(grouped_data)
plot(pca$x[, 1], pca$x[, 2], pch=21, bg=c("blue","cyan","green")[grouped_data[,3]], main = "PCA", xlab = "PC1", ylab = "PC2")
# Create some data
expX<-rnorm(100,6,3)
expY<- 2+1.1*expX+rnorm(100,0,1)
par(pin=c(3,3),font=2,ps=10,family="sans")
plot(expX,expY,pch=21, xlab="Expression level gene X",ylab="Expression level gene Y")
expmatrix<-cbind(expX,expY)
exppca <- prcomp(expmatrix, center = TRUE, cor=TRUE, scores=TRUE)
plot(exppca,main = "PCA eigenvalues")
par(pin=c(5,2),font=2,ps=10,family="sans")
plot(exppca$x[, 1], exppca$x[, 2], pch=21, main = "PCA transformed data", xlab = "PC1", ylab = "PC2")
# 3 group example
geneX_groupA <- rnorm(200,3.2,0.8)
geneY_groupA <- rnorm(200,1.6,0.8)
geneZ_groupA <- rnorm(200,1.6,0.8)
geneX_groupB <- rnorm(200,5.0,0.8)
geneY_groupB <- rnorm(200,3.0,0.8)
geneZ_groupB <- rnorm(200,3,0.8)
geneX_groupC <- rnorm(60,4.0,0.6)
geneY_groupC <- rnorm(60,3.0,0.6)
geneZ_groupC <- rnorm(60,0.0,0.6)
collected_Xvalues <- c(geneX_groupA,geneX_groupB,geneX_groupC)
collected_Yvalues <- c(geneY_groupA,geneY_groupB,geneY_groupC)
collected_Zvalues <- c(geneZ_groupA,geneZ_groupB,geneZ_groupC)
matrix_data <- cbind(c(collected_Xvalues),c(collected_Yvalues),c(collected_Zvalues))
grouped_data <- data.frame(matrix_data,c(rep("A",200),rep("B",200),rep("C",60)))
plot(grouped_data[,1],grouped_data[,2], pch=21, xlab="Expression level gene X",ylab="Expression level gene Y",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
plot(grouped_data[,1],grouped_data[,3], pch=21, xlab="Expression level gene X",ylab="Expression level gene Z",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
plot(grouped_data[,2],grouped_data[,3], pch=21, xlab="Expression level gene Y",ylab="Expression level gene Z",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
pca <- prcomp(matrix_data, center = TRUE)
plot(pca$x[, 1], pca$x[, 2], pch=21, bg=c("blue","cyan","green")[grouped_data[,4]], main = "PCA", xlab = "PC1", ylab = "PC2")
#K means analysis
mydata<-data.frame(pca$x[, 1],-pca$x[, 2])
withingroupss <- (nrow(mydata)-1)*sum(apply(mydata,2,var))
for (i in 2:8) withingroupss[i] <- sum(kmeans(mydata,centers=i)$withinss)
par(pin=c(2,2),font=2,ps=10,family="sans")
plot(1:8, withingroupss[1:8], type="b", xlab="Number of Clusters", ylab="Within groups sum of squares")
# 3 looks like a good number
myclusters <- kmeans(mydata,3)
library(cluster)
clusplot(mydata, myclusters$cluster,color=TRUE, shade=TRUE, labels=1, lines=0)
library(cluster)
#(need to press ESC with mouse in graphics window to get out of clusplot)
# Create some data
expX<-rnorm(100,6,3)
expY<- 2+1.1*expX+rnorm(100,0,1)
par(pin=c(3,3),font=2,ps=10,family="sans")
plot(expX,expY,pch=21, xlab="Expression level gene X",ylab="Expression level gene Y")
expmatrix<-cbind(expX,expY)
exppca <- prcomp(expmatrix, center = TRUE, cor=TRUE, scores=TRUE)
plot(exppca,main = "PCA eigenvalues")
par(pin=c(5,2),font=2,ps=10,family="sans")
plot(exppca$x[, 1], exppca$x[, 2], pch=21, main = "PCA transformed data", xlab = "PC1", ylab = "PC2")
# 3 group example
geneX_groupA <- rnorm(200,3.2,0.8)
geneY_groupA <- rnorm(200,1.6,0.8)
geneZ_groupA <- rnorm(200,1.6,0.8)
geneX_groupB <- rnorm(200,5.0,0.8)
geneY_groupB <- rnorm(200,3.0,0.8)
geneZ_groupB <- rnorm(200,3,0.8)
geneX_groupC <- rnorm(60,4.0,0.6)
geneY_groupC <- rnorm(60,3.0,0.6)
geneZ_groupC <- rnorm(60,0.0,0.6)
collected_Xvalues <- c(geneX_groupA,geneX_groupB,geneX_groupC)
collected_Yvalues <- c(geneY_groupA,geneY_groupB,geneY_groupC)
collected_Zvalues <- c(geneZ_groupA,geneZ_groupB,geneZ_groupC)
matrix_data <- cbind(c(collected_Xvalues),c(collected_Yvalues),c(collected_Zvalues))
grouped_data <- data.frame(matrix_data,c(rep("A",200),rep("B",200),rep("C",60)))
plot(grouped_data[,1],grouped_data[,2], pch=21, xlab="Expression level gene X",ylab="Expression level gene Y",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
plot(grouped_data[,1],grouped_data[,3], pch=21, xlab="Expression level gene X",ylab="Expression level gene Z",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
plot(grouped_data[,2],grouped_data[,3], pch=21, xlab="Expression level gene Y",ylab="Expression level gene Z",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
pca <- prcomp(matrix_data, center = TRUE)
plot(pca$x[, 1], pca$x[, 2], pch=21, bg=c("blue","cyan","green")[grouped_data[,3]], main = "PCA", xlab = "PC1", ylab = "PC2")
#K means analysis
mydata<-data.frame(pca$x[, 1],-pca$x[, 2])
withingroupss <- (nrow(mydata)-1)*sum(apply(mydata,2,var))
for (i in 2:8) withingroupss[i] <- sum(kmeans(mydata,centers=i)$withinss)
par(pin=c(2,2),font=2,ps=10,family="sans")
plot(1:8, withingroupss[1:8], type="b", xlab="Number of Clusters", ylab="Within groups sum of squares")
# 3 looks like a good number
myclusters <- kmeans(mydata,3)
library(cluster)
clusplot(mydata, myclusters$cluster,color=TRUE, shade=TRUE, labels=1, lines=0)
library(cluster)
#(need to press ESC with mouse in graphics window to get out of clusplot)
# Create some data
expX<-rnorm(100,6,3)
expY<- 2+1.1*expX+rnorm(100,0,1)
par(pin=c(3,3),font=2,ps=10,family="sans")
plot(expX,expY,pch=21, xlab="Expression level gene X",ylab="Expression level gene Y")
expmatrix<-cbind(expX,expY)
exppca <- prcomp(expmatrix, center = TRUE, cor=TRUE, scores=TRUE)
plot(exppca,main = "PCA eigenvalues")
par(pin=c(5,2),font=2,ps=10,family="sans")
plot(exppca$x[, 1], exppca$x[, 2], pch=21, main = "PCA transformed data", xlab = "PC1", ylab = "PC2")
# 3 group example
geneX_groupA <- rnorm(200,3.2,0.8)
geneY_groupA <- rnorm(200,1.6,0.8)
geneZ_groupA <- rnorm(200,1.6,0.8)
geneX_groupB <- rnorm(200,5.0,0.8)
geneY_groupB <- rnorm(200,3.0,0.8)
geneZ_groupB <- rnorm(200,3,0.8)
geneX_groupC <- rnorm(60,4.0,0.6)
geneY_groupC <- rnorm(60,3.0,0.6)
geneZ_groupC <- rnorm(60,0.0,0.6)
collected_Xvalues <- c(geneX_groupA,geneX_groupB,geneX_groupC)
collected_Yvalues <- c(geneY_groupA,geneY_groupB,geneY_groupC)
collected_Zvalues <- c(geneZ_groupA,geneZ_groupB,geneZ_groupC)
matrix_data <- cbind(c(collected_Xvalues),c(collected_Yvalues),c(collected_Zvalues))
grouped_data <- data.frame(matrix_data,c(rep("A",200),rep("B",200),rep("C",60)))
plot(grouped_data[,1],grouped_data[,2], pch=21, xlab="Expression level gene X",ylab="Expression level gene Y",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
plot(grouped_data[,1],grouped_data[,3], pch=21, xlab="Expression level gene X",ylab="Expression level gene Z",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
plot(grouped_data[,2],grouped_data[,3], pch=21, xlab="Expression level gene Y",ylab="Expression level gene Z",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
pca <- prcomp(matrix_data, center = TRUE)
plot(pca$x[, 1], pca$x[, 2], pch=21, bg=c("blue","cyan","green")[grouped_data[,4]], main = "PCA", xlab = "PC1", ylab = "PC2")
#K means analysis
mydata<-data.frame(pca$x[, 1],-pca$x[, 2])
withingroupss <- (nrow(mydata)-1)*sum(apply(mydata,2,var))
for (i in 2:8) withingroupss[i] <- sum(kmeans(mydata,centers=i)$withinss)
par(pin=c(2,2),font=2,ps=10,family="sans")
plot(1:8, withingroupss[1:8], type="b", xlab="Number of Clusters", ylab="Within groups sum of squares")
# 3 looks like a good number
myclusters <- kmeans(mydata,3)
library(cluster)
clusplot(mydata, myclusters$cluster,color=TRUE, shade=TRUE, labels=1, lines=0)
library(cluster)
#(need to press ESC with mouse in graphics window to get out of clusplot)
setwd('C:/Dev/Github/LeucipPipelines/Pipelines/Crosslinks/01_SONOS/Csv/')
ddatanos <- read.csv("NOS_MEDIUM_03_Geometry.csv",stringsAsFactors = FALSE, row.names=NULL)
ddatanos$NZ.SG = as.numeric(ddatanos$NZ.SG)
ddatanos$NZ.O = as.numeric(ddatanos$NZ.O)
ddatanos$NZ.N = as.numeric(ddatanos$NZ.N)
ddatanos$NZ.SG2 = as.numeric(ddatanos$NZ.SG2)
ddatanos$NZ.NO2 = as.numeric(ddatanos$NZ.NO2)
ddatanos$NZ.NO3 = as.numeric(ddatanos$NZ.NO3)
numericdatanos<- dplyr::select (ddatanos,NZ.SG,NZ.O,NZ.N,NZ.SG2,NZ.NO2,NZ.NO3)
matrix_datanos <- cbind(ddatanos$NZ.SG,ddatanos$NZ.O,ddatanos$NZ.N,ddatanos$NZ.SG2,ddatanos$NZ.NO2,ddatanos$NZ.NO3)
len <- nrow(ddatanos)
grouped_datanos <- data.frame(matrix_datanos,c(rep("A",len),rep("B",len),rep("C",len),rep("D",len),rep("E",len),rep("F",len)))
rows = nrow(matrix_datanos)
pcanos <- prcomp(matrix_datanos, center = TRUE,scale=TRUE)
plot(pcanos$x[, 1], pcanos$x[, 2], pch=21, bg=c("blue","cyan","green","yellow","black","pink")[grouped_datanos[,6]], main = "PCA", xlab = "PC1", ylab = "PC2")
#K means analysis
mydatanos<-data.frame(pcanos$x[, 1],-pcanos$x[, 2])
withingroupssnos <- (nrow(mydatanos)-1)*sum(apply(mydatanos,2,var))
for (i in 2:8) withingroupssnos[i] <- sum(kmeans(mydatanos,centers=i)$withinss)
par(pin=c(2,2),font=2,ps=10,family="sans")
plot(1:8, withingroupssnos[1:8], type="b", xlab="Number of Clusters", ylab="Within groups sum of squares")
# 3 looks like a good number
myclustersnos <- kmeans(mydatanos,3)
library(cluster)
clusplot(mydatanos, myclustersnos$cluster,color=TRUE, shade=TRUE, labels=1, lines=0)
library(cluster)
#(need to press ESC with mouse in graphics window to get out of clusplot)
setwd('C:/Dev/Github/LeucipPipelines/Pipelines/Crosslinks/01_SONOS/Csv/')
ddatanos <- read.csv("NOS_MEDIUM_03_Geometry.csv",stringsAsFactors = FALSE, row.names=NULL)
ddatanos$NZ.SG = as.numeric(ddatanos$NZ.SG)
ddatanos$NZ.O = as.numeric(ddatanos$NZ.O)
ddatanos$NZ.N = as.numeric(ddatanos$NZ.N)
ddatanos$NZ.SG2 = as.numeric(ddatanos$NZ.SG2)
ddatanos$NZ.NO2 = as.numeric(ddatanos$NZ.NO2)
ddatanos$NZ.NO3 = as.numeric(ddatanos$NZ.NO3)
numericdatanos<- dplyr::select (ddatanos,NZ.SG,NZ.O,NZ.N,NZ.SG2,NZ.NO2,NZ.NO3)
matrix_datanos <- cbind(ddatanos$NZ.SG,ddatanos$NZ.O,ddatanos$NZ.N,ddatanos$NZ.SG2,ddatanos$NZ.NO2,ddatanos$NZ.NO3)
len <- nrow(ddatanos)
grouped_datanos <- data.frame(matrix_datanos,c(rep("A",len),rep("B",len),rep("C",len),rep("D",len),rep("E",len),rep("F",len)))
rows = nrow(matrix_datanos)
pcanos <- prcomp(matrix_datanos, center = TRUE,scale=FALSE)
plot(pcanos$x[, 1], pcanos$x[, 2], pch=21, bg=c("blue","cyan","green","yellow","black","pink")[grouped_datanos[,6]], main = "PCA", xlab = "PC1", ylab = "PC2")
#K means analysis
mydatanos<-data.frame(pcanos$x[, 1],-pcanos$x[, 2])
withingroupssnos <- (nrow(mydatanos)-1)*sum(apply(mydatanos,2,var))
for (i in 2:8) withingroupssnos[i] <- sum(kmeans(mydatanos,centers=i)$withinss)
par(pin=c(2,2),font=2,ps=10,family="sans")
plot(1:8, withingroupssnos[1:8], type="b", xlab="Number of Clusters", ylab="Within groups sum of squares")
# 3 looks like a good number
myclustersnos <- kmeans(mydatanos,3)
library(cluster)
clusplot(mydatanos, myclustersnos$cluster,color=TRUE, shade=TRUE, labels=1, lines=0)
library(cluster)
#(need to press ESC with mouse in graphics window to get out of clusplot)
plot(pcanos$x[, 1], pcanos$x[, 2], pch=21, bg=c("blue","cyan","green","yellow","black","pink")[grouped_datanos[,7]], main = "PCA", xlab = "PC1", ylab = "PC2")
plot(pcanos$x[, 1], pcanos$x[, 2], pch=21, bg=c("blue","cyan","green","yellow","black","pink")[grouped_datanos[,6]], main = "PCA", xlab = "PC1", ylab = "PC2")
# Create some data
expX<-rnorm(100,6,3)
expY<- 2+1.1*expX+rnorm(100,0,1)
par(pin=c(3,3),font=2,ps=10,family="sans")
plot(expX,expY,pch=21, xlab="Expression level gene X",ylab="Expression level gene Y")
expmatrix<-cbind(expX,expY)
exppca <- prcomp(expmatrix, center = TRUE, cor=TRUE, scores=TRUE)
plot(exppca,main = "PCA eigenvalues")
par(pin=c(5,2),font=2,ps=10,family="sans")
plot(exppca$x[, 1], exppca$x[, 2], pch=21, main = "PCA transformed data", xlab = "PC1", ylab = "PC2")
# 3 group example
geneX_groupA <- rnorm(200,3.2,0.8)
geneY_groupA <- rnorm(200,1.6,0.8)
geneZ_groupA <- rnorm(200,1.6,0.8)
geneX_groupB <- rnorm(200,5.0,0.8)
geneY_groupB <- rnorm(200,3.0,0.8)
geneZ_groupB <- rnorm(200,3,0.8)
geneX_groupC <- rnorm(60,4.0,0.6)
geneY_groupC <- rnorm(60,3.0,0.6)
geneZ_groupC <- rnorm(60,0.0,0.6)
collected_Xvalues <- c(geneX_groupA,geneX_groupB,geneX_groupC)
collected_Yvalues <- c(geneY_groupA,geneY_groupB,geneY_groupC)
collected_Zvalues <- c(geneZ_groupA,geneZ_groupB,geneZ_groupC)
matrix_data <- cbind(c(collected_Xvalues),c(collected_Yvalues),c(collected_Zvalues))
grouped_data <- data.frame(matrix_data,c(rep("A",200),rep("B",200),rep("C",60)))
plot(grouped_data[,1],grouped_data[,2], pch=21, xlab="Expression level gene X",ylab="Expression level gene Y",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
plot(grouped_data[,1],grouped_data[,3], pch=21, xlab="Expression level gene X",ylab="Expression level gene Z",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
plot(grouped_data[,2],grouped_data[,3], pch=21, xlab="Expression level gene Y",ylab="Expression level gene Z",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
pca <- prcomp(matrix_data, center = TRUE)
plot(pca$x[, 1], pca$x[, 2], pch=21, bg=c("blue","cyan","green")[grouped_data[,4]], main = "PCA", xlab = "PC1", ylab = "PC2")
#K means analysis
mydata<-data.frame(pca$x[, 1],-pca$x[, 2])
withingroupss <- (nrow(mydata)-1)*sum(apply(mydata,2,var))
for (i in 2:8) withingroupss[i] <- sum(kmeans(mydata,centers=i)$withinss)
par(pin=c(2,2),font=2,ps=10,family="sans")
plot(1:8, withingroupss[1:8], type="b", xlab="Number of Clusters", ylab="Within groups sum of squares")
# 3 looks like a good number
myclusters <- kmeans(mydata,3)
library(cluster)
clusplot(mydata, myclusters$cluster,color=TRUE, shade=TRUE, labels=1, lines=0)
library(cluster)
#(need to press ESC with mouse in graphics window to get out of clusplot)
# Create some data
expX<-rnorm(100,6,3)
expY<- 2+1.1*expX+rnorm(100,0,1)
par(pin=c(3,3),font=2,ps=10,family="sans")
plot(expX,expY,pch=21, xlab="Expression level gene X",ylab="Expression level gene Y")
expmatrix<-cbind(expX,expY)
exppca <- prcomp(expmatrix, center = TRUE, cor=TRUE, scores=TRUE)
plot(exppca,main = "PCA eigenvalues")
par(pin=c(5,2),font=2,ps=10,family="sans")
plot(exppca$x[, 1], exppca$x[, 2], pch=21, main = "PCA transformed data", xlab = "PC1", ylab = "PC2")
# 3 group example
geneX_groupA <- rnorm(200,3.2,0.8)
geneY_groupA <- rnorm(200,1.6,0.8)
geneZ_groupA <- rnorm(200,1.6,0.8)
geneX_groupB <- rnorm(200,5.0,0.8)
geneY_groupB <- rnorm(200,3.0,0.8)
geneZ_groupB <- rnorm(200,3,0.8)
geneX_groupC <- rnorm(60,4.0,0.6)
geneY_groupC <- rnorm(60,3.0,0.6)
geneZ_groupC <- rnorm(60,0.0,0.6)
collected_Xvalues <- c(geneX_groupA,geneX_groupB,geneX_groupC)
collected_Yvalues <- c(geneY_groupA,geneY_groupB,geneY_groupC)
collected_Zvalues <- c(geneZ_groupA,geneZ_groupB,geneZ_groupC)
matrix_data <- cbind(c(collected_Xvalues),c(collected_Yvalues),c(collected_Zvalues))
#grouped_data <- data.frame(matrix_data,c(rep("A",200),rep("B",200),rep("C",60)))
grouped_data <- data.frame(matrix_data,as.factor(c(rep("A",200),rep("B",200),rep("C",60))))
plot(grouped_data[,1],grouped_data[,2], pch=21, xlab="Expression level gene X",ylab="Expression level gene Y",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
plot(grouped_data[,1],grouped_data[,3], pch=21, xlab="Expression level gene X",ylab="Expression level gene Z",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
plot(grouped_data[,2],grouped_data[,3], pch=21, xlab="Expression level gene Y",ylab="Expression level gene Z",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
pca <- prcomp(matrix_data, center = TRUE)
plot(pca$x[, 1], pca$x[, 2], pch=21, bg=c("blue","cyan","green")[grouped_data[,4]], main = "PCA", xlab = "PC1", ylab = "PC2")
#K means analysis
mydata<-data.frame(pca$x[, 1],-pca$x[, 2])
withingroupss <- (nrow(mydata)-1)*sum(apply(mydata,2,var))
for (i in 2:8) withingroupss[i] <- sum(kmeans(mydata,centers=i)$withinss)
par(pin=c(2,2),font=2,ps=10,family="sans")
plot(1:8, withingroupss[1:8], type="b", xlab="Number of Clusters", ylab="Within groups sum of squares")
# 3 looks like a good number
myclusters <- kmeans(mydata,3)
library(cluster)
clusplot(mydata, myclusters$cluster,color=TRUE, shade=TRUE, labels=1, lines=0)
library(cluster)
#(need to press ESC with mouse in graphics window to get out of clusplot)
setwd('C:/Dev/Github/LeucipPipelines/Pipelines/Crosslinks/01_SONOS/Csv/')
ddatanos <- read.csv("NOS_MEDIUM_03_Geometry.csv",stringsAsFactors = FALSE, row.names=NULL)
ddatanos$NZ.SG = as.numeric(ddatanos$NZ.SG)
ddatanos$NZ.O = as.numeric(ddatanos$NZ.O)
ddatanos$NZ.N = as.numeric(ddatanos$NZ.N)
ddatanos$NZ.SG2 = as.numeric(ddatanos$NZ.SG2)
ddatanos$NZ.NO2 = as.numeric(ddatanos$NZ.NO2)
ddatanos$NZ.NO3 = as.numeric(ddatanos$NZ.NO3)
numericdatanos<- dplyr::select (ddatanos,NZ.SG,NZ.O,NZ.N,NZ.SG2,NZ.NO2,NZ.NO3)
matrix_datanos <- cbind(ddatanos$NZ.SG,ddatanos$NZ.O,ddatanos$NZ.N,ddatanos$NZ.SG2,ddatanos$NZ.NO2,ddatanos$NZ.NO3)
len <- nrow(ddatanos)
grouped_datanos <- data.frame(matrix_datanos,as.factor(c(rep("A",len),rep("B",len),rep("C",len),rep("D",len),rep("E",len),rep("F",len))))
rows = nrow(matrix_datanos)
pcanos <- prcomp(matrix_datanos, center = TRUE,scale=FALSE)
plot(pcanos$x[, 1], pcanos$x[, 2], pch=21, bg=c("blue","cyan","green","yellow","black","pink")[grouped_datanos[,7]], main = "PCA", xlab = "PC1", ylab = "PC2")
#K means analysis
mydatanos<-data.frame(pcanos$x[, 1],-pcanos$x[, 2])
withingroupssnos <- (nrow(mydatanos)-1)*sum(apply(mydatanos,2,var))
for (i in 2:8) withingroupssnos[i] <- sum(kmeans(mydatanos,centers=i)$withinss)
par(pin=c(2,2),font=2,ps=10,family="sans")
plot(1:8, withingroupssnos[1:8], type="b", xlab="Number of Clusters", ylab="Within groups sum of squares")
# 3 looks like a good number
myclustersnos <- kmeans(mydatanos,3)
library(cluster)
clusplot(mydatanos, myclustersnos$cluster,color=TRUE, shade=TRUE, labels=1, lines=0)
library(cluster)
#(need to press ESC with mouse in graphics window to get out of clusplot)
grouped_datanos <- data.frame(matrix_datanos,as.factor(c(rep("A",len),rep("B",len),rep("C",len),rep("D",len),rep("E",len),rep("F",len))))
rows = nrow(matrix_datanos)
pcanos <- prcomp(matrix_datanos, center = TRUE,scale=FALSE)
plot(pcanos$x[, 1], pcanos$x[, 2], pch=21, bg=c("blue","cyan","green","yellow","black","pink")[grouped_datanos[,7]], main = "PCA", xlab = "PC1", ylab = "PC2")
p<-c(0.25,0.25,0.25,0.25)
obs <-c(410,789,573,394)
chi_square <- function(p,obs) {
a<-sum(obs)
x.sq<-0
for (i in 1:length(p)) {
exp<-a*p[i]
x.sq<-x.sq+(((obs[i]-exp)^2)/exp)
}
if (x.sq >= qchisq(0.95,(length(p)-1))) {
print("null is rejected")
}
else {
print("null is accepted")
}
}
p<-c(0.25,0.25,0.25,0.25)
obs <-c(410,789,573,394)
chi_square <- function(p,obs) {
a<-sum(obs)
x.sq<-0
for (i in 1:length(p)) {
exp<-a*p[i]
x.sq<-x.sq+(((obs[i]-exp)^2)/exp)
}
if (x.sq >= qchisq(0.95,(length(p)-1))) {
print("null is rejected")
}
else {
print("null is accepted")
}
}
# Create some data
expX<-rnorm(100,6,3)
expY<- 2+1.1*expX+rnorm(100,0,1)
par(pin=c(3,3),font=2,ps=10,family="sans")
plot(expX,expY,pch=21, xlab="Expression level gene X",ylab="Expression level gene Y")
expmatrix<-cbind(expX,expY)
exppca <- prcomp(expmatrix, center = TRUE, cor=TRUE, scores=TRUE)
plot(exppca,main = "PCA eigenvalues")
par(pin=c(5,2),font=2,ps=10,family="sans")
plot(exppca$x[, 1], exppca$x[, 2], pch=21, main = "PCA transformed data", xlab = "PC1", ylab = "PC2")
# 3 group example
geneX_groupA <- rnorm(200,3.2,0.8)
geneY_groupA <- rnorm(200,1.6,0.8)
geneZ_groupA <- rnorm(200,1.6,0.8)
geneX_groupB <- rnorm(200,5.0,0.8)
geneY_groupB <- rnorm(200,3.0,0.8)
geneZ_groupB <- rnorm(200,3,0.8)
geneX_groupC <- rnorm(60,4.0,0.6)
geneY_groupC <- rnorm(60,3.0,0.6)
geneZ_groupC <- rnorm(60,0.0,0.6)
collected_Xvalues <- c(geneX_groupA,geneX_groupB,geneX_groupC)
collected_Yvalues <- c(geneY_groupA,geneY_groupB,geneY_groupC)
collected_Zvalues <- c(geneZ_groupA,geneZ_groupB,geneZ_groupC)
matrix_data <- cbind(c(collected_Xvalues),c(collected_Yvalues),c(collected_Zvalues))
#grouped_data <- data.frame(matrix_data,c(rep("A",200),rep("B",200),rep("C",60)))
grouped_data <- data.frame(matrix_data,as.factor(c(rep("A",200),rep("B",200),rep("C",60))))
plot(grouped_data[,1],grouped_data[,2], pch=21, xlab="Expression level gene X",ylab="Expression level gene Y",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
plot(grouped_data[,1],grouped_data[,3], pch=21, xlab="Expression level gene X",ylab="Expression level gene Z",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
plot(grouped_data[,2],grouped_data[,3], pch=21, xlab="Expression level gene Y",ylab="Expression level gene Z",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
pca <- prcomp(matrix_data, center = TRUE)
plot(pca$x[, 1], pca$x[, 2], pch=21, bg=c("blue","cyan","green")[grouped_data[,4]], main = "PCA", xlab = "PC1", ylab = "PC2")
#K means analysis
mydata<-data.frame(pca$x[, 1],-pca$x[, 2])
withingroupss <- (nrow(mydata)-1)*sum(apply(mydata,2,var))
for (i in 2:8) withingroupss[i] <- sum(kmeans(mydata,centers=i)$withinss)
par(pin=c(2,2),font=2,ps=10,family="sans")
plot(1:8, withingroupss[1:8], type="b", xlab="Number of Clusters", ylab="Within groups sum of squares")
# 3 looks like a good number
myclusters <- kmeans(mydata,3)
library(cluster)
clusplot(mydata, myclusters$cluster,color=TRUE, shade=TRUE, labels=1, lines=0)
library(cluster)
#(need to press ESC with mouse in graphics window to get out of clusplot)
setwd('C:/Dev/Github/LeucipPipelines/Pipelines/Crosslinks/01_SONOS/Csv/')
ddatanos <- read.csv("NOS_MEDIUM_03_Geometry.csv",stringsAsFactors = FALSE, row.names=NULL)
ddatanos$NZ.SG = as.numeric(ddatanos$NZ.SG)
ddatanos$NZ.O = as.numeric(ddatanos$NZ.O)
ddatanos$NZ.N = as.numeric(ddatanos$NZ.N)
ddatanos$NZ.SG2 = as.numeric(ddatanos$NZ.SG2)
ddatanos$NZ.NO2 = as.numeric(ddatanos$NZ.NO2)
ddatanos$NZ.NO3 = as.numeric(ddatanos$NZ.NO3)
numericdatanos<- dplyr::select (ddatanos,NZ.SG,NZ.O,NZ.N,NZ.SG2,NZ.NO2,NZ.NO3)
matrix_datanos <- cbind(ddatanos$NZ.SG,ddatanos$NZ.O,ddatanos$NZ.N,ddatanos$NZ.SG2,ddatanos$NZ.NO2,ddatanos$NZ.NO3)
len <- nrow(ddatanos)
grouped_datanos <- data.frame(matrix_datanos,as.factor(c(rep("A",len),rep("B",len),rep("C",len),rep("D",len),rep("E",len),rep("F",len))))
rows = nrow(matrix_datanos)
pcanos <- prcomp(matrix_datanos, center = TRUE,scale=FALSE)
plot(pcanos$x[, 1], pcanos$x[, 2], pch=21, bg=c("blue","cyan","green","yellow","black","pink")[grouped_datanos[,7]], main = "PCA", xlab = "PC1", ylab = "PC2")
#K means analysis
mydatanos<-data.frame(pcanos$x[, 1],pcanos$x[, 2])
withingroupssnos <- (nrow(mydatanos)-1)*sum(apply(mydatanos,2,var))
for (i in 2:8) withingroupssnos[i] <- sum(kmeans(mydatanos,centers=i)$withinss)
par(pin=c(2,2),font=2,ps=10,family="sans")
plot(1:8, withingroupssnos[1:8], type="b", xlab="Number of Clusters", ylab="Within groups sum of squares")
# 3 looks like a good number
myclustersnos <- kmeans(mydatanos,3)
library(cluster)
clusplot(mydatanos, myclustersnos$cluster,color=TRUE, shade=TRUE, labels=1, lines=0)
library(cluster)
#(need to press ESC with mouse in graphics window to get out of clusplot)
setwd('C:/Dev/Github/LeucipPipelines/Pipelines/Crosslinks/01_SONOS/Csv/')
ddatanos <- read.csv("NOS_MEDIUM_03_Geometry.csv",stringsAsFactors = FALSE, row.names=NULL)
ddatanos$NZ.SG = as.numeric(ddatanos$NZ.SG)
ddatanos$NZ.O = as.numeric(ddatanos$NZ.O)
ddatanos$NZ.N = as.numeric(ddatanos$NZ.N)
ddatanos$NZ.SG2 = as.numeric(ddatanos$NZ.SG2)
ddatanos$NZ.NO2 = as.numeric(ddatanos$NZ.NO2)
ddatanos$NZ.NO3 = as.numeric(ddatanos$NZ.NO3)
numericdatanos<- dplyr::select (ddatanos,NZ.SG,NZ.O,NZ.N,NZ.SG2,NZ.NO2,NZ.NO3)
matrix_datanos <- cbind(ddatanos$NZ.SG,ddatanos$NZ.O,ddatanos$NZ.N,ddatanos$NZ.SG2,ddatanos$NZ.NO2,ddatanos$NZ.NO3)
len <- nrow(ddatanos)
grouped_datanos <- data.frame(matrix_datanos,as.factor(c(rep("A",len),rep("B",len),rep("C",len),rep("D",len),rep("E",len),rep("F",len))))
rows = nrow(matrix_datanos)
pcanos <- prcomp(matrix_datanos, center = TRUE,scale=FALSE)
plot(pcanos$x[, 1], pcanos$x[, 2], pch=21, bg=c("blue","cyan","green","yellow","black","pink")[grouped_datanos[,7]], main = "PCA", xlab = "PC1", ylab = "PC2")
#K means analysis
mydatanos<-data.frame(pcanos$x[, 1],pcanos$x[, 2],pcanos$x[, 3],pcanos$x[, 4])
withingroupssnos <- (nrow(mydatanos)-1)*sum(apply(mydatanos,2,var))
for (i in 2:8) withingroupssnos[i] <- sum(kmeans(mydatanos,centers=i)$withinss)
par(pin=c(2,2),font=2,ps=10,family="sans")
plot(1:8, withingroupssnos[1:8], type="b", xlab="Number of Clusters", ylab="Within groups sum of squares")
# 3 looks like a good number
myclustersnos <- kmeans(mydatanos,3)
library(cluster)
clusplot(mydatanos, myclustersnos$cluster,color=TRUE, shade=TRUE, labels=1, lines=0)
library(cluster)
#(need to press ESC with mouse in graphics window to get out of clusplot)
# Create some data
expX<-rnorm(100,6,3)
expY<- 2+1.1*expX+rnorm(100,0,1)
par(pin=c(3,3),font=2,ps=10,family="sans")
plot(expX,expY,pch=21, xlab="Expression level gene X",ylab="Expression level gene Y")
expmatrix<-cbind(expX,expY)
exppca <- prcomp(expmatrix, center = TRUE, cor=TRUE, scores=TRUE)
plot(exppca,main = "PCA eigenvalues")
par(pin=c(5,2),font=2,ps=10,family="sans")
plot(exppca$x[, 1], exppca$x[, 2], pch=21, main = "PCA transformed data", xlab = "PC1", ylab = "PC2")
# 3 group example
geneX_groupA <- rnorm(200,3.2,0.8)
geneY_groupA <- rnorm(200,1.6,0.8)
geneZ_groupA <- rnorm(200,1.6,0.8)
geneX_groupB <- rnorm(200,5.0,0.8)
geneY_groupB <- rnorm(200,3.0,0.8)
geneZ_groupB <- rnorm(200,3,0.8)
geneX_groupC <- rnorm(60,4.0,0.6)
geneY_groupC <- rnorm(60,3.0,0.6)
geneZ_groupC <- rnorm(60,0.0,0.6)
collected_Xvalues <- c(geneX_groupA,geneX_groupB,geneX_groupC)
collected_Yvalues <- c(geneY_groupA,geneY_groupB,geneY_groupC)
collected_Zvalues <- c(geneZ_groupA,geneZ_groupB,geneZ_groupC)
matrix_data <- cbind(c(collected_Xvalues),c(collected_Yvalues),c(collected_Zvalues))
#grouped_data <- data.frame(matrix_data,c(rep("A",200),rep("B",200),rep("C",60)))
grouped_data <- data.frame(matrix_data,as.factor(c(rep("A",200),rep("B",200),rep("C",60))))
plot(grouped_data[,1],grouped_data[,2], pch=21, xlab="Expression level gene X",ylab="Expression level gene Y",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
plot(grouped_data[,1],grouped_data[,3], pch=21, xlab="Expression level gene X",ylab="Expression level gene Z",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
plot(grouped_data[,2],grouped_data[,3], pch=21, xlab="Expression level gene Y",ylab="Expression level gene Z",bg=c("blue","cyan","green")[grouped_data[,4]], main="")
pca <- prcomp(matrix_data, center = TRUE)
plot(pca$x[, 1], pca$x[, 2], pch=21, bg=c("blue","cyan","green")[grouped_data[,4]], main = "PCA", xlab = "PC1", ylab = "PC2")
#K means analysis
mydata<-data.frame(pca$x[, 1],-pca$x[, 2],pca$x[, 3])
withingroupss <- (nrow(mydata)-1)*sum(apply(mydata,2,var))
for (i in 2:8) withingroupss[i] <- sum(kmeans(mydata,centers=i)$withinss)
par(pin=c(2,2),font=2,ps=10,family="sans")
plot(1:8, withingroupss[1:8], type="b", xlab="Number of Clusters", ylab="Within groups sum of squares")
# 3 looks like a good number
myclusters <- kmeans(mydata,3)
library(cluster)
clusplot(mydata, myclusters$cluster,color=TRUE, shade=TRUE, labels=1, lines=0)
